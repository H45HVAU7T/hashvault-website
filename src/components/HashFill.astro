---
const { textSize } = Astro.props;
---

<div
  class=`flex-1 font-brutal font-black ${textSize} tracking-wider overflow-hidden`
>
  <div class="slashFill leading-none whitespace-nowrap">/</div>
</div>

<script>
  function updateSlashFills() {
    const elements = document.querySelectorAll(".slashFill");

    elements.forEach((element) => {
      const container = element?.parentElement;
      if (!element || !container) return;

      // First, clear the content to get the true available width
      element.textContent = "";

      // Now get the available width without the slash content
      const availableWidth = container.offsetWidth;

      // Use font measurement for accurate character width
      const testChar = document.createElement("span");
      testChar.textContent = "/";
      testChar.style.visibility = "hidden";
      testChar.style.position = "absolute";
      testChar.style.whiteSpace = "nowrap";
      testChar.style.fontFamily = getComputedStyle(element).fontFamily;
      testChar.style.fontSize = getComputedStyle(element).fontSize;
      testChar.style.fontWeight = getComputedStyle(element).fontWeight;
      testChar.style.letterSpacing = getComputedStyle(element).letterSpacing;

      container.appendChild(testChar);
      const charWidth = testChar.getBoundingClientRect().width;
      container.removeChild(testChar);

      const slashCount = Math.floor(availableWidth / charWidth);

      // Set the content to the calculated amount
      element.textContent = "/".repeat(Math.max(1, slashCount));
    });
  }

  // Wait until DOM is ready
  document.addEventListener("DOMContentLoaded", () => {
    requestAnimationFrame(() => {
      updateSlashFills();
      window.addEventListener("resize", updateSlashFills);
    });
  });
</script>
